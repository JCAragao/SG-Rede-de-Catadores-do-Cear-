using iTextSharp.text.pdf;
using iTextSharp.text;
using Org.BouncyCastle.Asn1.X509;
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Data.SqlTypes;

namespace Sistema_de_Gerenciamento_da_Rede_de_Catadores_do_Ceará__Versão_Teste_
{

    public partial class GestaoAdministradores : Form
    {
        public GestaoAdministradores()
        {
            InitializeComponent();
        }

        //Carregamento dos nomes das Associações
        private void GestaoAdministradores_Load(object sender, EventArgs e)
        {
            string NomedoServidor = lbl_NomedoServidor.Text;

            if (Globais.nivel == 0)
            {
                string vqueryAdministrador = @"select [Nome Fantasia] from [ASSOCIACAO] order by [Nome Fantasia] ASC";

                cbb_AssociacaoGestao.DataSource = ConexaoBancodeDados.dql(vqueryAdministrador, NomedoServidor);
                cbb_AssociacaoGestao.DisplayMember = "Nome Fantasia";

            }


            if (Globais.nivel == 1)
            {
                string vqueryAdministrador = @"select [Nome Fantasia] from [ASSOCIACAO] order by [Nome Fantasia] ASC";

                cbb_AssociacaoGestao.DataSource = ConexaoBancodeDados.dql(vqueryAdministrador, NomedoServidor);
                cbb_AssociacaoGestao.DisplayMember = "Nome Fantasia";
            }

        }

        //Recarregamento do nome da associação.
        private void cbb_Administradorestao_MouseUp(object sender, MouseEventArgs e)
        {
            string NomedoServidor = lbl_NomedoServidor.Text;
            if (Globais.nivel == 0)
            {
                string vqueryAdministrador = @"select [Nome Fantasia] from [ASSOCIACAO] order by [Nome Fantasia] ASC";

                cbb_AssociacaoGestao.DataSource = ConexaoBancodeDados.dql(vqueryAdministrador, NomedoServidor);
                cbb_AssociacaoGestao.DisplayMember = "Nome Fantasia";

            }


            if (Globais.nivel == 1)
            {
                string vqueryAdministrador = @"select [Nome Fantasia] from [ASSOCIACAO] order by [Nome Fantasia] ASC";

                cbb_AssociacaoGestao.DataSource = ConexaoBancodeDados.dql(vqueryAdministrador, NomedoServidor);
                cbb_AssociacaoGestao.DisplayMember = "Nome Fantasia";

            }


        }

        //Somente números são permitidos
        private void txt_MatriculaAdministradorGestao_KeyPress(object sender, KeyPressEventArgs e)
        {
            if ((!char.IsNumber(e.KeyChar)) && !char.IsControl(e.KeyChar))
            {
                e.Handled = true;
            }
        }


        //Eventos da marcação do radiobutton porMatricula
        private void rdb_porMatricula_CheckedChanged(object sender, EventArgs e)
        {
            txt_MatriculaAdministradorGestao.ReadOnly = false;
            txt_MatriculaAdministradorGestao.BackColor = Color.White;
            btn_PesquisarporMatriculaAdministradorGestao.Visible = true;
            btn_PesquisarPorAssociacaoGestao.Visible = false;
            btn_porAssociacaoeMatricula.Visible = false;
            cbb_AssociacaoGestao.Enabled = false;
        }

        //Eventos ao marcar o radiobutton porAssociacao
        private void rdb_porAssociacao_CheckedChanged(object sender, EventArgs e)
        {
            txt_MatriculaAdministradorGestao.ReadOnly = false;
            txt_MatriculaAdministradorGestao.BackColor = Color.LightGray;
            btn_PesquisarporMatriculaAdministradorGestao.Visible = false;
            btn_porAssociacaoeMatricula.Visible = false;
            btn_porAssociacaoeMatricula.Visible = false;
            btn_PesquisarPorAssociacaoGestao.Enabled = true;
            btn_PesquisarPorAssociacaoGestao.Visible = true;
            cbb_AssociacaoGestao.Visible = true;
            cbb_AssociacaoGestao.Enabled = true;
        }

        //Eventos de busca por Associação e Matrícula.

        private void btn_porAssociacaoeMatricula_Click(object sender, EventArgs e)
        {
            string NomedoServidor = lbl_NomedoServidor.Text;
            if (txt_MatriculaAdministradorGestao.Text != "" && cbb_AssociacaoGestao.SelectedIndex != -1)
            {

                if (Globais.nivel == 0)
                {
                    string Associacao = cbb_AssociacaoGestao.Text;
                    string Matricula = txt_MatriculaAdministradorGestao.Text;


                    string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], [txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], [txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], [txt_Bairro], [txt_CEP], [nud_Nivel], [Unidade], [Usuario] FROM [ADMINISTRADORES] WHERE [Unidade] = '" + Associacao + "' AND ID_doAdministrador = '" + Matricula + "' ORDER BY txt_NomeAdministrador ASC";
                    dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                }

                if (Globais.nivel == 1)
                {
                    string Associacao = cbb_AssociacaoGestao.Text;
                    string Matricula = txt_MatriculaAdministradorGestao.Text;

                    string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], [txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], [txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], [txt_Bairro], [txt_CEP], [nud_Nivel], [Administrador], [Unidade] FROM [ADMINISTRADORES] WHERE [nud_Nivel] = 2 AND [Unidade] = '" + Associacao + "' AND ID_doAdministrador = '" + Matricula + "' ORDER BY txt_NomeAdministrador ASC";
                    dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                }
            }

            else
            {
                MessageBox.Show("Digite uma matrícula e escolha uma associação.");
                return;

            }
        }

        //Eventos de busca por Associação
        private void btn_PesquisarPorAssociacaoGestao_Click(object sender, EventArgs e)
        {
            string NomedoServidor = lbl_NomedoServidor.Text;
            if (cbb_AssociacaoGestao.SelectedIndex == -1)
            {
                MessageBox.Show("Escolha uma associação da lista.");
                return;

            }
            else
            {

                if (Globais.nivel == 0)
                {
                    string Associacao = (cbb_AssociacaoGestao.Text);

                    string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador],  [txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], [txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], [txt_Bairro], [txt_CEP], [nud_Nivel], [Unidade], [Usuario] FROM [ADMINISTRADORES] WHERE [Unidade] ='" + Associacao + "'ORDER BY txt_NomeAdministrador ASC";
                    dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                }

                if (Globais.nivel == 1)
                {
                    string Administrador = cbb_AssociacaoGestao.Text;
                    string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], [txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS],  [txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade],  [txt_Bairro], [txt_CEP], [nud_Nivel], [Administrador], [Unidade] FROM [ADMINISTRADORES] WHERE  [txt_NomeAdministrador] ='" + Administrador + "' AND [nud_Nivel] = 2 ORDER BY txt_NomeAdministrador ASC";
                    dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);


                }
            }
        }

            //Eventos de busca por Matrícula.
            private void btn_PesquisarporMatriculaAdministradorGestao_Click(object sender, EventArgs e)
        {
            string NomedoServidor = lbl_NomedoServidor.Text;
            if (txt_MatriculaAdministradorGestao.Text == "")
            {
                MessageBox.Show("Digite um número de matrícula.");
                return;

            }
            else
            {
                if (Globais.nivel == 0)
                {
                    string Matricula = txt_MatriculaAdministradorGestao.Text;
                    string vqueryCatador = @"SELECT[ID_doAdministrador], [txt_NomeAdministrador], [txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], [txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], [txt_Bairro], [txt_CEP], [nud_Nivel], [Unidade], [Usuario] FROM[ADMINISTRADORES] WHERE [ID_doAdministrador] = '" + Matricula + "'ORDER BY txt_NomeAdministrador ASC";
                    dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                }

                if (Globais.nivel == 1)
                {

                    string Matricula = txt_MatriculaAdministradorGestao.Text;
                    string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], [txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], [txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], [txt_Bairro], [txt_CEP], [nud_Nivel], [Administrador], [Unidade] FROM [ADMINISTRADORES] WHERE [ID_doAdministrador] ='" + Matricula + "' AND [nud_Nivel] = 2 ORDER BY txt_NomeAdministrador ASC";
                    dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);

                }
            }
        }


        //Eventos de exclusão de administrador.
        private void btn_ExcluirEditarColetasGestao_Click(object sender, EventArgs e)
        {
            string NomedoServidor = lbl_NomedoServidor.Text;

            if (dgv_AdministradorGestao.Rows.Count == 0)
            {
                MessageBox.Show("Administrador não selecionado.");
                return;

            }
            else
            {
                var Aviso = MessageBox.Show("Esta ação será irreversível. Deseja continuar?", "Exclusão de administrador", MessageBoxButtons.YesNo);

                if (Aviso == DialogResult.Yes)
                {

                    //Exclusão do administrador
                    string IDdoAdministrador = this.dgv_AdministradorGestao.CurrentRow.Cells[0].Value.ToString();
                    string PaiMaeAdministrador = this.dgv_AdministradorGestao.CurrentRow.Cells[1].Value.ToString();
                    string ExclusaoAdministrador = @"DELETE FROM ADMINISTRADORES WHERE [ID_doAdministrador] = '" + IDdoAdministrador + "'";
                    string ExclusaoFilhosAdministrador = @"DELETE FROM FILHOS WHERE [Pai/Mae]='" + PaiMaeAdministrador + "';";
                    ConexaoBancodeDados.dql(ExclusaoAdministrador, NomedoServidor);
                    ConexaoBancodeDados.dql(ExclusaoFilhosAdministrador, NomedoServidor);
                    MessageBox.Show("Administrador(a) excluído(a) com sucesso!");

                    if (btn_PesquisarPorAssociacaoGestao.Visible == true)
                    {

                        if (cbb_AssociacaoGestao.SelectedIndex == -1)
                        {
                            MessageBox.Show("Escolha uma associação da lista.");
                            return;

                        }
                        else
                        {
                            //Atualização do Data Grid View após alteração

                            if (Globais.nivel == 0)
                            {
                                string Associacao = (cbb_AssociacaoGestao.Text);

                                string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], 
[txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS],
[txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade],
[txt_Bairro], [txt_CEP], [nud_Nivel], [Unidade], [Usuario] FROM [ADMINISTRADORES] WHERE
[Unidade] ='" + Associacao + "'ORDER BY txt_NomeAdministrador ASC";
                                dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                            }

                            if (Globais.nivel == 1)
                            {
                                string Administrador = cbb_AssociacaoGestao.Text;
                                string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], 
[txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], 
[txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], 
[txt_Bairro], [txt_CEP], [nud_Nivel], [Administrador], [Unidade] FROM [ADMINISTRADORES] WHERE 
[txt_NomeAdministrador] ='" + Administrador + "' AND [nud_Nivel] = 2 ORDER BY txt_NomeAdministrador ASC";
                                dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);

                            }
                        }

                    }

                    //Atualização do Data Grid View após exclusão
                    if (btn_PesquisarporMatriculaAdministradorGestao.Visible == true)
                    {
                        if (txt_MatriculaAdministradorGestao.Text == "")
                        {
                            MessageBox.Show("Digite um número de matrícula.");
                            return;

                        }
                        else
                        {
                            if (Globais.nivel == 0)
                            {
                                string Matricula = txt_MatriculaAdministradorGestao.Text;
                                string vqueryCatador = @"SELECT[ID_doAdministrador], [txt_NomeAdministrador],
[txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS],
[txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade],
[txt_Bairro], [txt_CEP], [nud_Nivel], [Unidade], [Usuario] FROM[ADMINISTRADORES] WHERE
[ID_doAdministrador] = '" + Matricula + "'ORDER BY txt_NomeAdministrador ASC";
                                dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                            }

                            if (Globais.nivel == 1)
                            {

                                string Matricula = txt_MatriculaAdministradorGestao.Text;
                                string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], [txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], [txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], [txt_Bairro], [txt_CEP], [nud_Nivel], [Administrador], [Unidade] FROM [ADMINISTRADORES] WHERE [ID_doAdministrador] ='" + Matricula + "' AND [nud_Nivel] = 2 ORDER BY txt_NomeAdministrador ASC";
                                dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);


                            }
                        }

                    }

                    //Atualização do Data Grid View após alteração

                    if (btn_porAssociacaoeMatricula.Visible == true)
                    {
                        if (Globais.nivel == 0)
                        {
                            string Associacao = cbb_AssociacaoGestao.Text;
                            string Matricula = txt_MatriculaAdministradorGestao.Text;


                            string vqueryCatador = @"SELECT[ID_doAdministrador], [txt_NomeAdministrador],
[txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS],
[txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade],
[txt_Bairro], [txt_CEP], [nud_Nivel], [Unidade], [Usuario] FROM[ADMINISTRADORES] WHERE
[Unidade] = '" + Associacao + "' AND ID_doAdministrador = '" + Matricula + "' ORDER BY txt_NomeAdministrador ASC";
                            dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                        }

                        if (Globais.nivel == 1)
                        {
                            string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], [txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], [txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], [txt_Bairro], [txt_CEP], [nud_Nivel], [Administrador], [Unidade] FROM [ADMINISTRADORES] WHERE [nud_Nivel] = 2 ORDER BY txt_NomeAdministrador ASC";
                            dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                        }

                    }
                }
                else
                {
                    return;
                }
            }
        }

        //Chamada do formulário de edição de administrador e transferência de dados.
        private void btn_EditarAdministradorGestao_Click(object sender, EventArgs e)
        {
            btn_EditarAdministradorGestao.Enabled = false;
            string NomedoServidor = lbl_NomedoServidor.Text;
            if (dgv_AdministradorGestao.Rows.Count == 0)
            {
                MessageBox.Show("Administrador não selecionado.");
                return;


            }
            else
            {
                
                Criptografia cryptography = new Criptografia(System.Configuration.ConfigurationManager.AppSettings[""]);
                string BairroCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[13].Value.ToString());
                string CEPCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[15].Value.ToString());
                string CidadeCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[12].Value.ToString());
                string CPFCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[7].Value.ToString());
                string DatadeMatriculaCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[5].Value.ToString());
                string DatadeNascimentoCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[4].Value.ToString());
                string emailCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[11].Value.ToString());
                string RuaCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[14].Value.ToString());
                string GeneroCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[9].Value.ToString());
                string LoginCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[2].Value.ToString());
                string NISCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[8].Value.ToString());
                string RGCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[6].Value.ToString());
                string TelefoneCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[10].Value.ToString());
                string SenhaCrip = cryptography.Decriptar(this.dgv_AdministradorGestao.CurrentRow.Cells[3].Value.ToString());

                EditarAdministrador administradoreditado = new EditarAdministrador();
                administradoreditado.txt_MatriculaAdministradorEditar.Text = this.dgv_AdministradorGestao.CurrentRow.Cells[0].Value.ToString();
                administradoreditado.txt_NomeCompletoEditarAdministrador.Text = this.dgv_AdministradorGestao.CurrentRow.Cells[1].Value.ToString();
                administradoreditado.txt_NomedeUsuarioEditarAdministrador.Text = LoginCrip;
                administradoreditado.txt_SenhaEditarAdministrador.Text = SenhaCrip;
                administradoreditado.txt_ConfirmarsenhaEditarAdministrador.Text = SenhaCrip;
                administradoreditado.txt_DatadeNascimentoEditarAdministrador.Text = DatadeNascimentoCrip;
                administradoreditado.txt_DatadeMatriculaEditarAdministrador.Text = DatadeMatriculaCrip;
                administradoreditado.txt_RGEditarAdministrador.Text = RGCrip;
                administradoreditado.txt_CPFEditarAdministrador.Text = CPFCrip;
                administradoreditado.txt_NISEditarAdministrador.Text = NISCrip;
                administradoreditado.cbb_GeneroEditarAdministrador.Text = GeneroCrip;
                administradoreditado.txt_TelefoneEditarAdministrador.Text = TelefoneCrip;
                administradoreditado.txt_emailEditarAdministrador.Text = emailCrip;
                administradoreditado.cbb_CidadeEditarAdministrador.Text = CidadeCrip;
                administradoreditado.txt_BairroEditarAdministrador.Text = BairroCrip;
                administradoreditado.txt_RuaEditarAdministrador.Text = RuaCrip;
                administradoreditado.txt_CEPEditarAdministrador.Text = CEPCrip;
                administradoreditado.lbl_NomedoServidor.Text = lbl_NomedoServidor.Text;
                administradoreditado.Show();
            }
        }

        //Eventos de impressão. Utiliza o ITextSharp.
        private void btn_ImprimirColetasGestao_Click(object sender, EventArgs e)
        {

            if (dgv_AdministradorGestao.Rows.Count == 0)
            {
                MessageBox.Show("Administrador não selecionado.");
                return;

            }

            if (btn_PesquisarporMatriculaAdministradorGestao.Visible == true)

            {

                string nomeAdministrador = cbb_AssociacaoGestao.Text;
                //Localiza o diretório de criação
                string nomeArquivo = Globais.caminhoImpressao + @"\INFORMACOESADM" + nomeAdministrador + ".pdf";
                //Cria o arquivo
                FileStream arquivoPDF = new FileStream(nomeArquivo, FileMode.Create);

                //Formatação do documento
                Document doc = new Document(PageSize.A4.Rotate(), 50f, 50f, 0f, 0f);
                doc.SetPageSize(doc.PageSize);
                PdfWriter escritorPDF = PdfWriter.GetInstance(doc, arquivoPDF);
                escritorPDF.PageEvent = new ImprimirInfoClassecs();

                //Localização e inserção da logo padrão da Associação de catadores.
                iTextSharp.text.Image Logotipo = iTextSharp.text.Image.GetInstance(Globais.caminho + @"\RededeCatadoresdoCeará.png");
                Logotipo.ScaleToFit(140f, 120f);
                Logotipo.SetAbsolutePosition(100f, 480f);

                doc.Open();
                string dados = "";

                //Cabeçalho local
                Paragraph paragrafo = new Paragraph(dados, new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 14, (int)System.Drawing.FontStyle.Bold));
                paragrafo.Alignment = Element.ALIGN_CENTER;
                paragrafo.Add("Rede dos Catadores de RSR do Estado do Ceará");
                Paragraph paragrafo2 = new Paragraph(dados, new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 14, (int)System.Drawing.FontStyle.Bold));
                paragrafo2.Alignment = Element.ALIGN_CENTER;
                paragrafo2.Add("Informaçoes do Administrador");
                Paragraph paragrafo3 = new Paragraph(dados, new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 14, (int)System.Drawing.FontStyle.Bold));
                paragrafo3.Alignment = Element.ALIGN_CENTER;
                paragrafo3.Add(this.dgv_AdministradorGestao.CurrentRow.Cells[1].Value.ToString());

                //Tabela de informações
                PdfPTable tabela1 = new PdfPTable(8);
                tabela1.HorizontalAlignment = Element.ALIGN_TOP;
                tabela1.SpacingBefore = 50;
                tabela1.WidthPercentage = 100;

                tabela1.AddCell("Administrador");
                tabela1.AddCell("Data de Nasc.");
                tabela1.AddCell("Data de Matr.");
                tabela1.AddCell("Gênero");
                tabela1.AddCell("Telefone");
                tabela1.AddCell("RG");
                tabela1.AddCell("CPF");
                tabela1.AddCell("NIS");

                string NomedoServidor = lbl_NomedoServidor.Text;
                string administrador = this.dgv_AdministradorGestao.CurrentRow.Cells[0].Value.ToString();
                string vqueryCatadorImpressao = @"SELECT [txt_NomeAdministrador], [txt_DatadeNascimento], [txt_DatadeMatricula],  [cbb_Genero],  [txt_Telefone], [txt_RG], [txt_CPF], [txt_NIS] FROM [ADMINISTRADORES] WHERE [ID_doAdministrador] ='" + administrador + "' ORDER BY txt_NomeAdministrador ASC";

                DataTable dtCatadorImpressao = ConexaoBancodeDados.dql(vqueryCatadorImpressao, NomedoServidor);
                for (int i = 0; i < dtCatadorImpressao.Rows.Count; i++)
                {
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("txt_NomeAdministrador"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("txt_DatadeNascimento"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("txt_DatadeMatricula"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("cbb_Genero"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<string>("txt_Telefone"))), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<Decimal>("txt_RG"))).ToString(), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular))); ;
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<Decimal>("txt_CPF"))).ToString(), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<Decimal>("txt_NIS"))).ToString(), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));

                }


                PdfPTable tabela2 = new PdfPTable(5);
                tabela2.TotalWidth = 500;
                tabela2.HorizontalAlignment = Element.ALIGN_BOTTOM;
                tabela2.SpacingBefore = 30;
                tabela2.WidthPercentage = 81;


                tabela2.AddCell("e-mail");
                tabela2.AddCell("Cidade");
                tabela2.AddCell("Bairro");
                tabela2.AddCell("Rua");
                tabela2.AddCell("CEP");


                string Administrador2 = this.dgv_AdministradorGestao.CurrentRow.Cells[0].Value.ToString();
                string vqueryCatadorImpressao2 = @"SELECT [txt_[e-mail]]], [cbb_Cidade], [txt_Bairro], [txt_Endereco], [txt_CEP] FROM ADMINISTRADORES WHERE [ID_doAdministrador] ='" + Administrador2 + "'ORDER BY txt_NomeAdministrador ASC ;";

                DataTable dtCatadorImpressao2 = ConexaoBancodeDados.dql(vqueryCatadorImpressao2, NomedoServidor);
                for (int i2 = 0; i2 < dtCatadorImpressao2.Rows.Count; i2++)
                {
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_[e-mail]"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("cbb_Cidade"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_Bairro"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_Endereco"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_CEP"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));

                }

                //Adição dos dados no documento.
                doc.Add(Logotipo);
                doc.Add(paragrafo);
                doc.Add(paragrafo2);
                doc.Add(paragrafo3);
                doc.Add(tabela1);
                doc.Add(tabela2);
                doc.Close();
            }


            
            if (btn_PesquisarPorAssociacaoGestao.Visible == true)

            {
                string nomeAdministrador = cbb_AssociacaoGestao.Text;
                string nomeArquivo = Globais.caminhoImpressao + @"\INFORMACOESADM" + nomeAdministrador + ".pdf";
                FileStream arquivoPDF = new FileStream(nomeArquivo, FileMode.Create);

                Document doc = new Document(PageSize.A4.Rotate(), 50f, 50f, 0f, 0f);
                doc.SetPageSize(doc.PageSize);
                PdfWriter escritorPDF = PdfWriter.GetInstance(doc, arquivoPDF);
                escritorPDF.PageEvent = new ImprimirInfoClassecs();

                iTextSharp.text.Image Logotipo = iTextSharp.text.Image.GetInstance(Globais.caminho + @"\RededeCatadoresdoCeará.png");
                Logotipo.ScaleToFit(140f, 120f);
                Logotipo.SetAbsolutePosition(100f, 480f);

                doc.Open();
                string dados = "";

                Paragraph paragrafo = new Paragraph(dados, new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 14, (int)System.Drawing.FontStyle.Bold));
                paragrafo.Alignment = Element.ALIGN_CENTER;
                paragrafo.Add("Rede dos Catadores de RSR do Estado do Ceará");
                Paragraph paragrafo2 = new Paragraph(dados, new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 14, (int)System.Drawing.FontStyle.Bold));
                paragrafo2.Alignment = Element.ALIGN_CENTER;
                paragrafo2.Add("Informaçoes do Administrador");
                Paragraph paragrafo3 = new Paragraph(dados, new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 14, (int)System.Drawing.FontStyle.Bold));
                paragrafo3.Alignment = Element.ALIGN_CENTER;
                paragrafo3.Add(this.dgv_AdministradorGestao.CurrentRow.Cells[1].Value.ToString());


                PdfPTable tabela1 = new PdfPTable(8);
                tabela1.HorizontalAlignment = Element.ALIGN_TOP;
                tabela1.SpacingBefore = 50;
                tabela1.WidthPercentage = 100;

                tabela1.AddCell("Administrador");
                tabela1.AddCell("Data de Nasc.");
                tabela1.AddCell("Data de Matr.");
                tabela1.AddCell("Gênero");
                tabela1.AddCell("Telefone");
                tabela1.AddCell("RG");
                tabela1.AddCell("CPF");
                tabela1.AddCell("NIS");

                string NomedoServidor = lbl_NomedoServidor.Text;
                string associacao = this.dgv_AdministradorGestao.CurrentRow.Cells[17].Value.ToString();
                string vqueryCatadorImpressao = @"SELECT [txt_NomeAdministrador], [txt_DatadeNascimento], [txt_DatadeMatricula],  [cbb_Genero],  [txt_Telefone], [txt_RG], [txt_CPF], [txt_NIS] FROM [ADMINISTRADORES] WHERE [Unidade] ='" + associacao + "' ORDER BY txt_NomeAdministrador ASC";

                DataTable dtCatadorImpressao = ConexaoBancodeDados.dql(vqueryCatadorImpressao, NomedoServidor);
                for (int i = 0; i < dtCatadorImpressao.Rows.Count; i++)
                {
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("txt_NomeAdministrador"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("txt_DatadeNascimento"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("txt_DatadeMatricula"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("cbb_Genero"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<string>("txt_Telefone"))), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<Decimal>("txt_RG"))).ToString(), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular))); ;
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<Decimal>("txt_CPF"))).ToString(), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<Decimal>("txt_NIS"))).ToString(), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));

                }


                PdfPTable tabela2 = new PdfPTable(5);
                tabela2.TotalWidth = 500;
                tabela2.HorizontalAlignment = Element.ALIGN_BOTTOM;
                tabela2.SpacingBefore = 30;
                tabela2.WidthPercentage = 81;


                tabela2.AddCell("e-mail");
                tabela2.AddCell("Cidade");
                tabela2.AddCell("Bairro");
                tabela2.AddCell("Rua");
                tabela2.AddCell("CEP");


                string associacao2 = this.dgv_AdministradorGestao.CurrentRow.Cells[17].Value.ToString();
                string vqueryCatadorImpressao2 = @"SELECT [txt_[e-mail]]], [cbb_Cidade], [txt_Bairro], [txt_Endereco], [txt_CEP] FROM ADMINISTRADORES WHERE [Unidade] ='" + associacao2 + "'ORDER BY txt_NomeAdministrador ASC ;";

                DataTable dtCatadorImpressao2 = ConexaoBancodeDados.dql(vqueryCatadorImpressao2, NomedoServidor);
                for (int i2 = 0; i2 < dtCatadorImpressao2.Rows.Count; i2++)
                {
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_[e-mail]"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("cbb_Cidade"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_Bairro"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_Endereco"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_CEP"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));

                }

                doc.Add(Logotipo);
                doc.Add(paragrafo);
                doc.Add(paragrafo2);
                doc.Add(paragrafo3);
                doc.Add(tabela1);
                doc.Add(tabela2);
                doc.Close();
            }

            if (btn_porAssociacaoeMatricula.Visible == true)

            {
                string nomeAdministrador = cbb_AssociacaoGestao.Text;
                string nomeArquivo = Globais.caminhoImpressao + @"\INFORMACOESADM" + nomeAdministrador + ".pdf";
                FileStream arquivoPDF = new FileStream(nomeArquivo, FileMode.Create);

                Document doc = new Document(PageSize.A4.Rotate(), 50f, 50f, 0f, 0f);
                doc.SetPageSize(doc.PageSize);
                PdfWriter escritorPDF = PdfWriter.GetInstance(doc, arquivoPDF);
                escritorPDF.PageEvent = new ImprimirInfoClassecs();

                iTextSharp.text.Image Logotipo = iTextSharp.text.Image.GetInstance(Globais.caminho + @"\RededeCatadoresdoCeará.png");
                Logotipo.ScaleToFit(140f, 120f);
                Logotipo.SetAbsolutePosition(100f, 480f);

                doc.Open();
                string dados = "";

                Paragraph paragrafo = new Paragraph(dados, new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 14, (int)System.Drawing.FontStyle.Bold));
                paragrafo.Alignment = Element.ALIGN_CENTER;
                paragrafo.Add("Rede dos Catadores de RSR do Estado do Ceará");
                Paragraph paragrafo2 = new Paragraph(dados, new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 14, (int)System.Drawing.FontStyle.Bold));
                paragrafo2.Alignment = Element.ALIGN_CENTER;
                paragrafo2.Add("Informaçoes do Administrador");
                Paragraph paragrafo3 = new Paragraph(dados, new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 14, (int)System.Drawing.FontStyle.Bold));
                paragrafo3.Alignment = Element.ALIGN_CENTER;
                paragrafo3.Add(this.dgv_AdministradorGestao.CurrentRow.Cells[1].Value.ToString());


                PdfPTable tabela1 = new PdfPTable(8);
                tabela1.HorizontalAlignment = Element.ALIGN_TOP;
                tabela1.SpacingBefore = 50;
                tabela1.WidthPercentage = 100;

                tabela1.AddCell("Administrador");
                tabela1.AddCell("Data de Nasc.");
                tabela1.AddCell("Data de Matr.");
                tabela1.AddCell("Gênero");
                tabela1.AddCell("Telefone");
                tabela1.AddCell("RG");
                tabela1.AddCell("CPF");
                tabela1.AddCell("NIS");

                string associacao = this.dgv_AdministradorGestao.CurrentRow.Cells[17].Value.ToString();
                string matricula = this.dgv_AdministradorGestao.CurrentRow.Cells[0].Value.ToString();
                string NomedoServidor = lbl_NomedoServidor.Text;
                string vqueryCatadorImpressao = @"SELECT [txt_NomeAdministrador], [txt_DatadeNascimento], [txt_DatadeMatricula],  [cbb_Genero],  [txt_Telefone], [txt_RG], [txt_CPF], [txt_NIS] FROM [ADMINISTRADORES] WHERE [Unidade] ='" + associacao + "'  AND [ID_Administrador] = '" + matricula + "' ORDER BY txt_NomeAdministrador ASC";

                DataTable dtCatadorImpressao = ConexaoBancodeDados.dql(vqueryCatadorImpressao, NomedoServidor);
                for (int i = 0; i < dtCatadorImpressao.Rows.Count; i++)
                {
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("txt_NomeAdministrador"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("txt_DatadeNascimento"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("txt_DatadeMatricula"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao.Rows[i].Field<string>("cbb_Genero"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<string>("txt_Telefone"))), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<Decimal>("txt_RG"))).ToString(), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular))); ;
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<Decimal>("txt_CPF"))).ToString(), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela1.AddCell(new PdfPCell()).AddElement(new Paragraph(((dtCatadorImpressao.Rows[i].Field<Decimal>("txt_NIS"))).ToString(), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));

                }


                PdfPTable tabela2 = new PdfPTable(5);
                tabela2.TotalWidth = 500;
                tabela2.HorizontalAlignment = Element.ALIGN_BOTTOM;
                tabela2.SpacingBefore = 30;
                tabela2.WidthPercentage = 81;


                tabela2.AddCell("e-mail");
                tabela2.AddCell("Cidade");
                tabela2.AddCell("Bairro");
                tabela2.AddCell("Rua");
                tabela2.AddCell("CEP");



                string associacao2 = this.dgv_AdministradorGestao.CurrentRow.Cells[17].Value.ToString();
                string matricula2 = this.dgv_AdministradorGestao.CurrentRow.Cells[0].Value.ToString();

                string vqueryCatadorImpressao2 = @"SELECT [txt_[e-mail]]], [cbb_Cidade], [txt_Bairro], [txt_Endereco], [txt_CEP] FROM ADMINISTRADORES WHERE [Unidade] ='" + associacao2 + "' AND [ID_Administrador] = '" + matricula2 + "' ORDER BY txt_NomeAdministrador ASC ;";

                DataTable dtCatadorImpressao2 = ConexaoBancodeDados.dql(vqueryCatadorImpressao2, NomedoServidor);
                for (int i2 = 0; i2 < dtCatadorImpressao2.Rows.Count; i2++)
                {
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_[e-mail]"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("cbb_Cidade"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_Bairro"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_Endereco"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));
                    tabela2.AddCell(new PdfPCell()).AddElement(new Paragraph(dtCatadorImpressao2.Rows[i2].Field<string>("txt_CEP"), new iTextSharp.text.Font(iTextSharp.text.Font.NORMAL, 10, (int)System.Drawing.FontStyle.Regular)));

                }

                doc.Add(Logotipo);
                doc.Add(paragrafo);
                doc.Add(paragrafo2);
                doc.Add(paragrafo3);
                doc.Add(tabela1);
                doc.Add(tabela2);
                doc.Close();
            }

        }

        //Atualizar os dados expostos no Data Grid View após alteração no banco de dados.
        private void dgv_AdministradorGestao_MouseEnter(object sender, EventArgs e)
        {
            btn_EditarAdministradorGestao.Enabled = true;

            string NomedoServidor = lbl_NomedoServidor.Text;
            if (dgv_AdministradorGestao.RowCount != 0)
            {
                if (btn_PesquisarPorAssociacaoGestao.Visible == true)
                {

                    if (Globais.nivel == 0)
                    {
                        string Associacao = (cbb_AssociacaoGestao.Text);

                        string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], 
[txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS],
[txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade],
[txt_Bairro], [txt_CEP], [nud_Nivel], [Unidade], [Usuario] FROM [ADMINISTRADORES] WHERE
[Unidade] ='" + Associacao + "'ORDER BY txt_NomeAdministrador ASC";
                        dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                    }

                    if (Globais.nivel == 1)
                    {
                        string Administrador = cbb_AssociacaoGestao.Text;
                        string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], 
[txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], 
[txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], 
[txt_Bairro], [txt_CEP], [nud_Nivel], [Administrador], [Unidade] FROM [ADMINISTRADORES] WHERE 
[txt_NomeAdministrador] ='" + Administrador + "' AND [nud_Nivel] = 2 ORDER BY txt_NomeAdministrador ASC";
                        dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);

                    }


                }

                if (btn_PesquisarporMatriculaAdministradorGestao.Visible == true)
                {

                    if (Globais.nivel == 0)
                    {
                        string Matricula = txt_MatriculaAdministradorGestao.Text;
                        string vqueryCatador = @"SELECT[ID_doAdministrador], [txt_NomeAdministrador],
[txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS],
[txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade],
[txt_Bairro], [txt_CEP], [nud_Nivel], [Unidade], [Usuario] FROM[ADMINISTRADORES] WHERE
[ID_doAdministrador] = '" + Matricula + "'ORDER BY txt_NomeAdministrador ASC";
                        dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                    }

                    if (Globais.nivel == 1)
                    {

                        string Matricula = txt_MatriculaAdministradorGestao.Text;
                        string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], [txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], [txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], [txt_Bairro], [txt_CEP], [nud_Nivel], [Administrador], [Unidade] FROM [ADMINISTRADORES] WHERE [ID_doAdministrador] ='" + Matricula + "' AND [nud_Nivel] = 2 ORDER BY txt_NomeAdministrador ASC";
                        dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);


                    }

                }
            }

            if (btn_porAssociacaoeMatricula.Visible == true && txt_MatriculaAdministradorGestao.Text != "")
            {
                if (Globais.nivel == 0)
                {
                    string Associacao = cbb_AssociacaoGestao.Text;
                    string Matricula = txt_MatriculaAdministradorGestao.Text;


                    string vqueryCatador = @"SELECT[ID_doAdministrador], [txt_NomeAdministrador], [txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], [txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], [txt_Bairro], [txt_CEP], [nud_Nivel], [Unidade], [Usuario] FROM[ADMINISTRADORES] WHERE [Unidade] = '" + Associacao + "' AND ID_doAdministrador = '" + Matricula + "' ORDER BY txt_NomeAdministrador ASC";
                    dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                }

                if (Globais.nivel == 1)
                {
                    string vqueryCatador = @"SELECT [ID_doAdministrador], [txt_NomeAdministrador], [txt_AdministradorLogin], [txt_SenhaLogin], [txt_DatadeNascimento], [txt_RG], [txt_CPF], [txt_NIS], [txt_DatadeMatricula], [cbb_Genero], [txt_Telefone], [txt_[e-mail]]], [txt_Endereco], [cbb_Cidade], [txt_Bairro], [txt_CEP], [nud_Nivel], [Administrador], [Unidade] FROM [ADMINISTRADORES] WHERE [nud_Nivel] = 2 ORDER BY txt_NomeAdministrador ASC";
                    dgv_AdministradorGestao.DataSource = ConexaoBancodeDados.dql(vqueryCatador, NomedoServidor);
                }
            }

        }

        //Fechar o formulário de gestão
        private void btn_CancelarEditarColetasGestao_Click(object sender, EventArgs e)
        {
            this.Close();
        }
    }
}

